---
// pokemon/[name].astro
import Layout from "../../layouts/Layout.astro";
import "../../styles/global.css";

const { id } = Astro.params;

let pokemon = null;
let error = null;



try {
  const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
  if (!response.ok) {
    throw new Error("Pokémon no encontrado");
  }
  pokemon = await response.json();
} catch (e) {
  error = `No se pudo cargar el pokémon: ${id}`;
  console.error(e);
}

export const prerender = false;
---

<Layout title={pokemon ? `${pokemon.name} - Pokedex` : "Error"}>
  <body
    class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen"
  >
    {
      error ? (
        <div class="text-center p-8">
          <h1 class="text-2xl text-red-500">{error}</h1>
          <a href="/" class="text-blue-500 hover:underline">
            ← Volver al inicio
          </a>
        </div>
      ) : (
        <img
          style={`view-transition-name:img-${pokemon.id}`}
          src={
            pokemon.sprites.other["official-artwork"].front_default ||
            pokemon.sprites.front_default
          }
          alt={pokemon.name}
          class="w-64 h-64 object-contain relative z-10"
        />

      )
    }
  </body>
</Layout>
